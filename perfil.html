<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Perfil - Artella</title>
  <link rel="stylesheet" href="style.css">
  <script>
    function carregarPerfil() {
      const user = JSON.parse(localStorage.getItem("usuarioLogado"));
      if (!user) {
        alert("Voc칡 precisa estar logado para acessar esta p치gina.");
        window.location.href = "login.html";
        return;
      }

      // Exibe dados b치sicos
      document.getElementById("nomeUsuario").textContent = user.usuario || user.nome;
      document.getElementById("emailUsuario").textContent = user.email;

      // Exibe desafios cadastrados por admin
      let desafios = JSON.parse(localStorage.getItem("desafios")) || [];
      const listaDesafios = document.getElementById("meus-desafios");
      listaDesafios.innerHTML = "";

      if (desafios.length === 0) {
        listaDesafios.innerHTML = "<p>Nenhum desafio publicado.</p>";
      } else {
        desafios.forEach((d, i) => {
          listaDesafios.innerHTML += `
            <div class="card desafio-card">
              <h3>Semana ${i + 1}</h3>
              <h4>${d.titulo}</h4>
              <p>${d.descricao}</p>
            </div>
          `;
        });
      }

      // Exibe trabalhos do usu치rio logado
      let trabalhos = JSON.parse(localStorage.getItem("trabalhos")) || [];
      const listaTrabalhos = document.getElementById("meus-trabalhos");
      listaTrabalhos.innerHTML = "";

      const meus = trabalhos.filter(t => t.autor === (user.usuario || user.nome));

      if (meus.length === 0) {
        listaTrabalhos.innerHTML = "<p>Nenhum trabalho enviado.</p>";
      } else {
        meus.forEach((t) => {
          listaTrabalhos.innerHTML += `
            <div class="card">
              ${t.imagem ? `<img src="${t.imagem}" alt="${t.titulo}" class="img-trabalho">` : ""}
              <h3>${t.titulo}</h3>
              <p><strong>${t.semana}</strong></p>
              <p>${t.descricao}</p>
            </div>
          `;
        });
      }
    }

    function logout() {
      localStorage.removeItem("usuarioLogado");
      window.location.href = "index.html";
    }
  </script>
</head>
<body class="perfil-bg" onload="carregarPerfil()">
<header class="header-rosa">
  <img src="C:\Users\ylpaim\Pictures\Screenshots\Captura de tela 2025-09-04 140455.png" alt="Logo Artella" class="logo-esq">
  <nav>
    <a href="index.html">In칤cio</a>
    <a href="desafios.html">Desafios</a>
    <a href="trabalhos.html">Publicar Trabalho</a>
    <a href="ver_trabalhos.html">Ver Trabalhos</a>
    <button onclick="logout()" class="btn-rosa">Sair</button>
  </nav>
</header>

<div class="container">
  <h2>Perfil do Usu치rio</h2>
  <p><strong>Usu치rio:</strong> <span id="nomeUsuario"></span></p>
  <p><strong>Email:</strong> <span id="emailUsuario"></span></p>

  <h3>游늷 Meus Desafios</h3>
  <div id="meus-desafios"></div>

  <h3>游꿛 Meus Trabalhos</h3>
  <div id="meus-trabalhos"></div>
</div>
</body>
</html>
